# é¡¹ç›®ä»‹ç»

æœ¬é¡¹ç›®å°†å®ç°ä¸€ä¸ªå…·å¤‡å®Œæ•´åŠŸèƒ½çš„ TodoList ç³»ç»Ÿï¼Œä¸»è¦åŠŸèƒ½æ¨¡å—åŒ…æ‹¬ï¼š

âœ… **ç”¨æˆ·è®¤è¯æ¨¡å—**

- ç”¨æˆ·æ³¨å†Œä¸ç™»å½•
- ç™»å‡ºåŠŸèƒ½
- ç”¨æˆ·ä¿¡æ¯æ›´æ–°
- å¤´åƒä¸Šä¼ 

âœ… **ä»»åŠ¡ç®¡ç†æ¨¡å—**

- ä»»åŠ¡çš„å¢åˆ æ”¹æŸ¥(CRUD)
- ä»»åŠ¡åˆ†ç±»ç®¡ç†
- çŠ¶æ€ä¸æˆªæ­¢æ—¶é—´ç®¡ç†

âœ… **å®‰å…¨æ§åˆ¶æ¨¡å—**

- JWT é‰´æƒæœºåˆ¶
- å…¨å±€å¼‚å¸¸å¤„ç†
- æ¥å£æƒé™æ§åˆ¶ï¼ˆç™»å½•/æœªç™»å½•çŠ¶æ€ï¼‰

ğŸ“¦ **æŠ€æœ¯æ ˆ**

- åç«¯ï¼šSpring Boot + Maven + MySQL
- å¯é€‰å‰ç«¯ï¼šReact, Vue
- æ¥å£æµ‹è¯•ï¼šApifox

> [!NOTE]
> **ä½œè€…å·²å®ç°éƒ¨åˆ†**
>
> - åŸºç¡€é¡¹ç›®æ¡†æ¶æ­å»º
> - å…¨å±€å¼‚å¸¸å¤„ç†æœºåˆ¶
> - DTO æ•°æ®ä¼ è¾“å¯¹è±¡è®¾è®¡
> - JWT é‰´æƒé…ç½®
> - å¸¸ç”¨å·¥å…·ç±»å°è£…
>
> **éœ€è¦å®ç°éƒ¨åˆ†**
>
> - æ•°æ®æŒä¹…å±‚ï¼ˆRepositoryï¼‰å¯ä»¥ä½¿ç”¨ JPA æˆ–è€… MyBatis. æ¥å£æ–‡ä»¶éƒ½åœ¨ `/src/repository` ä¸­, MayBatis çš„ `xml` æ–‡ä»¶éƒ½åœ¨ `/resources/mapper`
> - ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆServiceï¼‰
> - æ¥å£æ§åˆ¶å±‚ï¼ˆControllerï¼‰

---

# ç¯å¢ƒå‡†å¤‡

## 1. Maven æ¢æºé…ç½®

åˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆè·¯å¾„ï¼š`C:\Users\<ä½ çš„ç”¨æˆ·å>\.m2\settings.xml`ï¼‰ï¼š

```xml
<settings>
    <mirrors>
        <mirror>
            <id>aliyunmaven</id>
            <name>é˜¿é‡Œäº‘å…¬å…±ä»“åº“</name>
            <url>https://maven.aliyun.com/repository/public</url>
            <mirrorOf>central</mirrorOf>
        </mirror>
    </mirrors>
</settings>
```

æ‰§è¡Œä¾èµ–å®‰è£…ï¼š

```bash
mvn clean install -T 1C
```

## 2. JDK é…ç½®

![](./assets/image-20250422145405621.png)

![image-20250422145458973](./assets/image-20250422145458973.png)

![image-20250508110832882](./assets/image-20250508110832882.png)

è¦æ±‚ï¼š

- å¿…é¡»ä½¿ç”¨ JDK 21
- é…ç½®é¡¹ç›®SDKä¸º21ç‰ˆæœ¬

## 3. æ•°æ®åº“é…ç½®

1. åˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE
DATABASE TodoList;
USE
TodoList;
```

2. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆapplication.ymlï¼‰ï¼š

![image-20250507202946145](./assets/image-20250507202946145.png)

```yaml
spring:
    datasource:
        url: jdbc:mysql://localhost:3306/TodoList
        username: root  # ä¿®æ”¹ä¸ºä½ çš„æ•°æ®åº“è´¦å·
        password: root  # ä¿®æ”¹ä¸ºä½ çš„æ•°æ®åº“å¯†ç 
```

3. æµ‹è¯•æ•°æ®åº“è¿æ¥ï¼š
   ![](./assets/image-20250422150309907.png)![image-20250422150339347](./assets/image-20250422150339347.png)

------

# æ¥å£æµ‹è¯•æŒ‡å—

## Apifox ä½¿ç”¨è¯´æ˜

1. ä¸‹è½½æµ‹è¯•å¥—ä»¶ï¼š
   ![](./assets/image-20250507195854443.png)

2. å¯¼å…¥æµ‹è¯•é…ç½®ï¼š
   ![](./assets/PixPin_2025-05-07_20-05-17.gif)

3. ä¿®æ”¹å‰ç½® url. ä¿®æ”¹ä¸º `http://127.0.0.1:8080`

   ![image-20250508113353411](./assets/image-20250508113353411.png)

4. æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼š
   ![](./assets/image-20250507200810108.png)

âœ… æˆåŠŸæµ‹è¯•ç¤ºä¾‹ï¼š
![](./assets/image-20250507200901202.png)

------

# å¼€å‘æç¤º

1. ä½¿ç”¨ IDEA çš„ TODO åŠŸèƒ½å®šä½å¾…å®ç°ä»£ç ï¼š
   ![](./assets/image-20250507205434219.png)
2. å¯ç”¨è¢«æ³¨é‡Šçš„æ–¹æ³•ï¼ˆCtrl+/ï¼‰ï¼š
   ![](./assets/image-20250507205833967.png)
3. æ•°æ®åº“è¿é€šæ€§æ£€æŸ¥ï¼š
   ![](./assets/image-20250507201238700.png)
4. é…ç½®æ–‡ä»¶ä¿®æ”¹ç¤ºä¾‹(ä¿®æ”¹æˆä½ çš„mysqlçš„ç”¨æˆ·åå’Œå¯†ç ) ï¼š
   ![]( ./assets/image-20250507202851737.png)



é€šè¿‡ Swagger æµ‹è¯•æ³¨å†Œæ¥å£ï¼š

```url
http://localhost:8080/swagger-ui/index.html
```

![](./assets/image-20250422153319116.png)

-----------

# é¡¹ç›®è®¾è®¡

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚       â””â”€â”€ todo_list/
â”‚   â”‚           â”œâ”€â”€ controller/    # REST API æ¥å£å±‚
â”‚   â”‚           â”œâ”€â”€ service/       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚           â”œâ”€â”€ repository/    # æ•°æ®è®¿é—®å±‚(DAO)
â”‚   â”‚           â”œâ”€â”€ model/         # JPA å®ä½“ç±»
â”‚   â”‚           â”œâ”€â”€ dto/           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚           â”œâ”€â”€ config/        # é…ç½®ç±»
â”‚   â”‚           â”œâ”€â”€ exception/     # å¼‚å¸¸å¤„ç†
â”‚   â”‚           â”œâ”€â”€ security/      # å®‰å…¨é…ç½®
â”‚   â”‚           â”œâ”€â”€ utils/         # å·¥å…·ç±»
â”‚   â”‚           â””â”€â”€ Application.java
â”‚   â”œâ”€â”€ resources/
â”‚   â”‚   â”œâ”€â”€ application.yml       # YAML é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ db.migration/         # Flyway è¿ç§»è„šæœ¬
â””â”€â”€ test/                         # æµ‹è¯•ä»£ç 
```

## æ•°æ®æ¨¡å‹è®¾è®¡

### ğŸ‘¤ User ç”¨æˆ·æ¨¡å‹

| å­—æ®µ       | ç±»å‹   | è¯´æ˜               |
| ---------- | ------ | ------------------ |
| username   | String | ç”¨æˆ·åï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ |
| password   | String | åŠ å¯†åçš„å¯†ç        |
| avatar_url | String | å¤´åƒå­˜å‚¨åœ°å€       |

### ğŸ“ Task ä»»åŠ¡æ¨¡å‹ï¼ˆå¤šå¯¹ä¸€å…³ç³»ï¼‰

| å­—æ®µ             | ç±»å‹    | è¯´æ˜       |
| ---------------- | ------- | ---------- |
| task_name        | String  | ä»»åŠ¡åç§°   |
| task_description | String  | ä»»åŠ¡æè¿°   |
| deadline         | Long    | æˆªæ­¢æ—¶é—´æˆ³ |
| status           | Boolean | å®ŒæˆçŠ¶æ€   |
| todo_list_id     | Long    | æ‰€å±æ¸…å•ID |

### ğŸ“‚ TodoList ä»»åŠ¡æ¸…å•ï¼ˆä¸€å¯¹å¤šå…³ç³»ï¼‰

| å­—æ®µ     | ç±»å‹   | è¯´æ˜       |
| -------- | ------ | ---------- |
| category | String | æ¸…å•åˆ†ç±»   |
| user_id  | Long   | æ‰€å±ç”¨æˆ·ID |

------

## æ¥å£è§„èŒƒ

### ğŸ‘¤ ç”¨æˆ·ç›¸å…³æ¥å£

| ç«¯ç‚¹                | æ–¹æ³•  | å‚æ•°                        | è¯´æ˜                   |
| ------------------- | ----- | --------------------------- | ---------------------- |
| `/user/register`    | POST  | username, password          | ç”¨æˆ·æ³¨å†Œ               |
| `/user/login`       | POST  | username, password          | ç”¨æˆ·ç™»å½•ï¼ˆè¿”å›Cookieï¼‰ |
| `/user/logout`      | GET   | -                           | ç”¨æˆ·ç™»å‡º               |
| `/user/{id}`        | PATCH | username/password/avatarUrl | æ›´æ–°ç”¨æˆ·ä¿¡æ¯           |
| `/user/upload/{id}` | POST  | å›¾ç‰‡æ–‡ä»¶                    | ä¸Šä¼ ç”¨æˆ·å¤´åƒ           |

### ğŸ“‚ ä»»åŠ¡æ¸…å•æ¥å£


```
## ğŸ§© å‰ç«¯é€šç”¨å·¥å…·ä¸ç±»å‹å®šä¹‰è¯´æ˜

æœ¬æ–‡ä»¶ä¸»è¦è¯´æ˜äº†é¡¹ç›®ä¸­ `types/`ã€`utils/` ç›®å½•ä¸‹çš„å·¥å…·å‡½æ•°ã€ç±»å‹å®šä¹‰ä¸å…¨å±€é…ç½®ç”¨é€”åŠä½¿ç”¨æ–¹å¼

### ğŸ“ `types/index.tsx`

#### `WebResponse<T>`

ç»Ÿä¸€å®šä¹‰æ¥å£å“åº”ç»“æ„ï¼Œé€‚ç”¨äºæ‰€æœ‰åç«¯ API é€šä¿¡çš„æ³›å‹å°è£…ã€‚

```ts
export interface WebResponse<T> {
  code: number;        // çŠ¶æ€ç ï¼Œå¦‚ 200 è¡¨ç¤ºæˆåŠŸï¼Œ1004 è¡¨ç¤ºæœªç™»å½•ç­‰
  data?: T;            // è¿”å›çš„æ³›å‹æ•°æ®
  msg?: string;        // é”™è¯¯æˆ–æˆåŠŸæç¤ºä¿¡æ¯
  ts: number;          // æ—¶é—´æˆ³
  total?: number;      // æ•°æ®æ€»é‡ï¼ˆç”¨äºåˆ†é¡µï¼‰
}
```



### ğŸ“ `utils/index.ts`

ğŸ§© `cn(...)` å·¥å…·å‡½æ•°

```ts
import { clsx, type ClassValue } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

##### âœ… åŠŸèƒ½è¯´æ˜

- ç”¨äºåˆå¹¶å¤šä¸ªç±»åå­—ç¬¦ä¸²ï¼Œè‡ªåŠ¨è§£å†³ Tailwind CSS çš„ç±»å†²çªã€‚
- ç±»ä¼¼ `classnames`ï¼Œä½†å¢å¼ºäº† Tailwind ä¸“ç”¨çš„åˆå¹¶é€»è¾‘ã€‚

### ğŸ“ `utils/alova.ts`

#### ğŸŒ ç½‘ç»œè¯·æ±‚å°è£…

ä½¿ç”¨ alova é…åˆ fetch æ„å»ºç»Ÿä¸€è¯·æ±‚å™¨ã€‚

```ts
import { createAlova } from "alova";
import adapterFetch from "alova/fetch";

export const alova = createAlova({
  baseURL: "/api",
  requestAdapter: adapterFetch(),
  timeout: 5000,
  shareRequest: true,
  statesHook: ReactHook,
  responded: {
    onSuccess: async (response, _method) => {
      const res = await response.json();
      // é€šç”¨æ‹¦æˆªé€»è¾‘
    }
  }
});
```

##### ğŸ” é€šç”¨æ‹¦æˆªé€»è¾‘

- `1004`: æœªç™»å½• â†’ è·³è½¬ç™»å½•é¡µå¹¶æ¸…é™¤ç”¨æˆ·çŠ¶æ€ã€‚
- `502`: åç«¯æŒ‚äº† â†’ å¼¹å‡ºé”™è¯¯æç¤ºã€‚

### ğŸ“ `utils/global-router.ts`

#### ğŸŒ å…¨å±€è·¯ç”±è·³è½¬æ”¯æŒ

```ts
const globalRouter = { navigate: undefined } as {
  navigate?: NavigateFunction;
};

export default globalRouter;
```

##### ğŸ§­ ä½¿ç”¨æ–¹å¼ (å…·ä½“çš„ä½¿ç”¨åœ¨é¡¹ç›®ä»£ç é‡Œå†™äº†æ³¨é‡Š)

åœ¨ `layout.tsx` ä¸­åˆå§‹åŒ–ï¼š

```tsx
globalRouter.navigate = useNavigate();
```



## ğŸ“¦ çŠ¶æ€ç®¡ç†æ¨¡å—ï¼š`storages/`

### 1. `auth.ts` - ç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†

**è·¯å¾„**ï¼š`storages/auth.ts`
 **ä¾èµ–**ï¼š[Zustand](https://github.com/pmndrs/zustand)ã€`User` æ¨¡å‹

```ts
// storages/auth.ts

import { User } from "@/models/user";
import { create } from "zustand";
import { createJSONStorage, persist } from "zustand/middleware";

/**
 * âœ… è¯´æ˜ï¼š
 * å…¨å±€ç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†
 * - ä½¿ç”¨ zustand ç®¡ç†ç”¨æˆ·ç™»å½•ä¿¡æ¯
 * - æ”¯æŒæŒä¹…åŒ–å­˜å‚¨ï¼ˆlocalStorageï¼‰ï¼Œå®ç°åˆ·æ–°é¡µé¢åä»ä¿æŒç™»å½•
 *
 * âœ… ä¸ºä»€ä¹ˆä½¿ç”¨ zustandï¼Ÿ
 * - ç®€æ´è½»é‡
 * - ä½¿ç”¨ç®€å•ä½†åŠŸèƒ½å¼ºå¤§(persist)
 */

// ç”¨æˆ·çŠ¶æ€æ¥å£
interface AuthState {
    user?: User;                      // å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆåŒ…æ‹¬ç”¨æˆ·åã€å¤´åƒç­‰ï¼‰
    setUser: (user?: User) => void;  // è®¾ç½®ç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å½•åä½¿ç”¨ï¼‰
    clear: () => void;               // æ¸…ç©ºç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å‡ºæ—¶ä½¿ç”¨ï¼‰
}

// åˆ›å»ºçŠ¶æ€ç®¡ç†ï¼šuseAuthStore åŒ…å« user, setUser, clear
export const useAuthStore = create<AuthState>()(
    persist(
        (set, _get) => ({
            setUser: (user?: User) => set({ user }),     // è®¾ç½®ç”¨æˆ·
            clear: () => set({ user: undefined }),       // æ¸…ç©ºç”¨æˆ·
        }),
        {
            name: "auth",                                 // localStorage çš„ key åç§°
            storage: createJSONStorage(() => localStorage), // ä½¿ç”¨ localStorage å­˜å‚¨
        }
    )
);

```



#### âœ… åŠŸèƒ½è¯´æ˜

`auth.ts` ä½¿ç”¨ `zustand` ç®¡ç†å…¨å±€çš„ç”¨æˆ·è®¤è¯çŠ¶æ€ã€‚å®ƒè´Ÿè´£ï¼š

- å­˜å‚¨å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åã€å¤´åƒç­‰ï¼‰
- åœ¨ç”¨æˆ·ç™»å½•ã€é€€å‡ºæ—¶æ›´æ–°çŠ¶æ€
- åˆ©ç”¨ `zustand/middleware/persist` æ’ä»¶å°†çŠ¶æ€æŒä¹…åŒ–åˆ° `localStorage`ï¼Œæ”¯æŒé¡µé¢åˆ·æ–°åçš„çŠ¶æ€ä¿æŒ

#### ğŸ“˜ ä½¿ç”¨åœºæ™¯

- åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
- è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ç”¨äºå±•ç¤ºï¼ˆå¦‚å¤´åƒã€æ˜µç§°ï¼‰
- å®ç°é€€å‡ºç™»å½•æ—¶çš„çŠ¶æ€æ¸…é™¤
- é¡µé¢åˆ·æ–°åè‡ªåŠ¨ä¿æŒç™»å½•çŠ¶æ€

é€šè¿‡ `useAuthStore()` å¯è®¿é—®ï¼š

- `user`: å½“å‰ç”¨æˆ·å¯¹è±¡ï¼ˆå¯ä¸ºç©ºï¼‰
- `setUser(user?: User)`: è®¾ç½®ç”¨æˆ·ä¿¡æ¯
- `clear()`: æ¸…é™¤ç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å‡ºæ—¶è°ƒç”¨ï¼‰

### 2. `shared.ts` - é€šç”¨åˆ·æ–°çŠ¶æ€ç®¡ç†

**è·¯å¾„**ï¼š`storages/shared.ts`
 **ä¾èµ–**ï¼šä»…ä¾èµ– `zustand`

```ts
// storages/shared.ts

import { create } from "zustand";

/**
 * âœ… è¯´æ˜ï¼š
 * ç”¨äºç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€çš„å…¨å±€ store
 * å½“å‰ä»…ç”¨äºæä¾›é¡µé¢/ç»„ä»¶åˆ·æ–°ä¿¡å·
 *
 * ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼š
 * - ç”¨æˆ·æ›´æ–°ä¿¡æ¯åï¼Œéœ€è¦å…¶ä»–ç»„ä»¶é‡æ–°æ‹‰å–æ•°æ®
 * - ç‚¹å‡»æŸä¸ªæ“ä½œï¼Œæƒ³é€šçŸ¥å¤šä¸ªç»„ä»¶é‡æ–°åŠ è½½
 */

// å…±äº«çŠ¶æ€æ¥å£
interface SharedState {
    refresh: number;        // æ¯æ¬¡æ›´æ–°éƒ½ä¼šè‡ªå¢ï¼Œè§¦å‘ä¾èµ–è¯¥å€¼çš„ç»„ä»¶é‡æ–°æ¸²æŸ“
    setRefresh: () => void; // æ‰§è¡Œä¸€æ¬¡åˆ·æ–°ï¼šrefresh + 1
}

// åˆ›å»ºå…±äº«çŠ¶æ€ç®¡ç†ï¼šuseSharedStore åŒ…å« refresh å’Œ setRefresh
export const useSharedStore = create<SharedState>()((set, get) => ({
    refresh: 0,
    setRefresh: () => set({ refresh: get().refresh + 1 }),
}));

```



#### âœ… åŠŸèƒ½è¯´æ˜

`shared.ts` æä¾›ä¸€ä¸ªç®€å•çš„å…¨å±€çŠ¶æ€ `refresh`ï¼Œç”¨äºè·¨ç»„ä»¶ä¼ é€’â€œåˆ·æ–°ä¿¡å·â€ã€‚

- é€šè¿‡é€’å¢çš„ `refresh` æ•°å€¼ï¼Œå®ç°ä¾èµ–ç»„ä»¶çš„å“åº”å¼åˆ·æ–°
- é€‚åˆç”¨åœ¨â€œæŸä¸ªåœ°æ–¹æ•°æ®å˜äº†ï¼Œå…¶ä»–åœ°æ–¹éœ€è¦æ„ŸçŸ¥å¹¶åˆ·æ–°â€è¿™ç§åœºæ™¯ä¸­

#### ğŸ“˜ ä½¿ç”¨åœºæ™¯ (åœ¨update-list-dialogä¸­çš„ä¾‹å­)

```tsx
const sharedStore = useSharedStore()
const onSubmit = form.handleSubmit(async (values) => {
        setLoading(true)
        try {
            ...
            if (res.code === 200) {
                sharedStore.setRefresh()// åœ¨æ“ä½œæˆåŠŸåæ‰‹åŠ¨è§¦å‘ä¸€æ¬¡å…¨å±€åˆ·æ–°ä¿¡å·ï¼Œä¾§è¾¹æ ä¼šå‡ºç°æ–°çš„liståå­—
                onClose()
                navigate(`/list/${values.category}`)//ç„¶åè·³è½¬åˆ°æ›´æ–°çš„listé¡µé¢
            } ...
        } catch (err) {
           ...
        } finally {
            ...
        }
    })
return (
    ...
    <Form{...form}>
    	...
        <form onSubmit={onSubmit}...>
        	<Button
            ...
            type={"submit"}>
        	...
        	</Button>
        </form>
    </Form>
```



é€šè¿‡ `useSharedStore()` å¯è®¿é—®ï¼š

- `refresh`: æ•°å€¼ï¼Œæ¯æ¬¡è°ƒç”¨ `setRefresh()` éƒ½ä¼š +1
- `setRefresh()`: ç”¨äºæ‰‹åŠ¨è§¦å‘åˆ·æ–°



## ğŸ“ `models/user.ts` æ¨¡å—è¯´æ˜æ–‡æ¡£

### âœ… ä½œç”¨

å®šä¹‰é¡¹ç›®ä¸­ä¸ã€Œç”¨æˆ·ï¼ˆUserï¼‰ã€ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œå³ `User` ç±»å‹æ¥å£ã€‚å®ƒç”¨äºæ ‡è¯†ã€çº¦æŸç”¨æˆ·å¯¹è±¡åŒ…å«çš„å­—æ®µç±»å‹ï¼Œæ˜¯æ•´ä¸ªé¡¹ç›®åœ¨ç™»å½•ã€æ³¨å†Œã€æ›´æ–°ç”¨æˆ·ä¿¡æ¯ç­‰æ“ä½œä¸­ç»Ÿä¸€ä½¿ç”¨çš„ç”¨æˆ·æ¨¡å‹ã€‚

### ğŸ“¦ User æ¥å£å­—æ®µè¯´æ˜

```ts
export interface User {
    id?: number; // ç”¨æˆ· ID
    username?: string; // ç”¨æˆ·å
    password?: string; // å¯†ç ï¼ˆç™»å½•æˆ–æ³¨å†Œæ—¶ç”¨ï¼‰
    confirm_password?: string; // ç¡®è®¤å¯†ç ï¼ˆæ³¨å†Œæ—¶ä½¿ç”¨ï¼‰
    avatarUrl?: string; // ç”¨æˆ·å¤´åƒ URL
}
```

> æ‰€æœ‰å­—æ®µå‡ä¸º ?ï¼ˆ`è¡¨ç¤ºå¯é€‰`ï¼‰ï¼Œä»¥æ–¹ä¾¿åœ¨è¡¨å•å¤„ç†ã€å±€éƒ¨æ›´æ–°æ—¶ä½¿ç”¨ã€‚

### ğŸ§  ä½¿ç”¨åœºæ™¯

- æ³¨å†Œè¡¨å•ä¸­ï¼Œä½¿ç”¨ `User` æ¨¡å‹è¿›è¡Œç±»å‹æ¨å¯¼ï¼›
- ç™»å½•å“åº”ä¸­ï¼ŒæœåŠ¡ç«¯è¿”å›çš„ç”¨æˆ·æ•°æ®ç»Ÿä¸€ä½¿ç”¨è¯¥ç»“æ„ï¼›
- åœ¨å…¨å±€çŠ¶æ€ `auth.ts` ä¸­å­˜å‚¨çš„ `user` ç±»å‹ä¹Ÿæ˜¯è¯¥æ¥å£ã€‚

## ğŸ“ `api/user/index.ts` æ¨¡å—è¯´æ˜æ–‡æ¡£

### âœ… ä½œç”¨

å°è£…ä¸ã€Œç”¨æˆ·ã€ç›¸å…³çš„æ‰€æœ‰ API è¯·æ±‚æ–¹æ³•ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½é€šè¿‡ `alova` è¯·æ±‚å®ä¾‹å‘å‡ºï¼Œå¹¶ç»Ÿä¸€ä½¿ç”¨ `WebResponse` ç±»å‹å°è£…å“åº”ç»“æœã€‚

### ğŸ“¡ API ä¸€è§ˆè¡¨

| æ–¹æ³•å         | è¯·æ±‚è·¯å¾„         | è¯·æ±‚æ–¹å¼ | ç”¨é€”         |
| -------------- | ---------------- | -------- | ------------ |
| `login`        | `/user/login`    | POST     | ç™»å½•         |
| `logout`       | `/user/logout`   | GET      | æ³¨é”€ç™»å½•     |
| `register`     | `/user/register` | POST     | æ³¨å†Œè´¦å·     |
| `updateUser`   | `/user`          | PATCH    | ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ |
| `uploadAvatar` | `/user/upload`   | POST     | ä¸Šä¼ ç”¨æˆ·å¤´åƒ |



### ğŸ§© è¯·æ±‚ç±»å‹å®šä¹‰

```ts
// ç™»å½•è¯·æ±‚ä½“
export interface UserLoginRequest {
    username: string;
    password: string;
}

// æ³¨å†Œè¯·æ±‚ä½“
export interface UserRegisterRequest {
    username: string;
    password: string;
    confirm_password: string;
}

// æ›´æ–°ç”¨æˆ·ä¿¡æ¯è¯·æ±‚ä½“
export interface UserUpdateRequest {
    id: number;
    username?: string;
    password?: string;
}
```



### ğŸ”„ å“åº”æ ¼å¼ç»Ÿä¸€å°è£…

æ‰€æœ‰ API å“åº”éƒ½ä½¿ç”¨å¦‚ä¸‹é€šç”¨æ ¼å¼å°è£…ï¼š

```ts
interface WebResponse<T> {
    code: number;
    data?: T;
    msg?: string;
    ts: number;
    total?: number;
}
```

ä¾‹å¦‚ï¼š

- ç™»å½•è¿”å›ï¼š`WebResponse<User>`
- ä¸Šä¼ å¤´åƒè¿”å›ï¼š`WebResponse<string>`ï¼ˆè¿”å›å¤´åƒåœ°å€ï¼‰
=======
| ç«¯ç‚¹                         | æ–¹æ³•   | å‚æ•°     | è¯´æ˜             |
| ---------------------------- | ------ | -------- | ---------------- |
| `/list/{category}`           | PUT    | category | åˆ›å»ºæ–°ä»»åŠ¡æ¸…å•   |
| `/list/{id}`                 | DELETE | -        | åˆ é™¤æŒ‡å®šæ¸…å•     |
| `/list/change_category/{id}` | PATCH  | category | ä¿®æ”¹æ¸…å•åˆ†ç±»     |
| `/list/`                     | GET    | -        | è·å–æ‰€æœ‰æ¸…å•     |
| `/list/{id}`                 | GET    | -        | è·å–æŒ‡å®šæ¸…å•è¯¦æƒ… |

### ğŸ“ ä»»åŠ¡ç®¡ç†æ¥å£

| ç«¯ç‚¹         | æ–¹æ³•   | å‚æ•°                         | è¯´æ˜         |
| ------------ | ------ | ---------------------------- | ------------ |
| `/task/`     | POST   | category, name, status=false | åˆ›å»ºæ–°ä»»åŠ¡   |
| `/task/{id}` | GET    | -                            | è·å–ä»»åŠ¡è¯¦æƒ… |
| `/task/{id}` | DELETE | -                            | åˆ é™¤ä»»åŠ¡     |
| `/task/{id}` | PATCH  | ä»»æ„ä»»åŠ¡å­—æ®µ                 | æ›´æ–°ä»»åŠ¡ä¿¡æ¯ |

------

## å¼‚å¸¸å¤„ç†è§„èŒƒ

### ğŸ‘¤ ç”¨æˆ·ç›¸å…³å¼‚å¸¸

| å¼‚å¸¸æè¿°         | é”™è¯¯ç  | è§¦å‘åœºæ™¯                   |
| ---------------- | ------ | -------------------------- |
| éæ³•ç”¨æˆ·å       | 1001   | ç”¨æˆ·åä¸ç¬¦åˆæ ¼å¼è§„èŒƒ       |
| ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ | 1002   | ç™»å½•éªŒè¯å¤±è´¥               |
| ç”¨æˆ·åå·²å­˜åœ¨     | 1003   | é‡å¤æ³¨å†Œ                   |
| æœªç™»å½•è®¿é—®       | 1004   | æ— æœ‰æ•ˆCookieè®¿é—®å—ä¿æŠ¤æ¥å£ |
| ç”¨æˆ·ä¸å­˜åœ¨       | 1005   | æ›´æ–°ä¸å­˜åœ¨çš„ç”¨æˆ·ä¿¡æ¯       |

### ğŸ“ ä»»åŠ¡ç›¸å…³å¼‚å¸¸

| å¼‚å¸¸æè¿°     | é”™è¯¯ç  | è§¦å‘åœºæ™¯               |
| ------------ | ------ | ---------------------- |
| éæ³•æ—¶é—´å‚æ•° | 2001   | è¶…è¿‡2038å¹´çš„æ—¶é—´æˆ³     |
| ä»»åŠ¡ä¸å­˜åœ¨   | 2002   | æ“ä½œä¸å­˜åœ¨ä»»åŠ¡         |
| è¿‡å»æ—¶é—´è®¾ç½® | 2003   | è®¾ç½®è¿‡å»æ—¶é—´ä¸ºæˆªæ­¢æ—¶é—´ |
| éæ³•çŠ¶æ€å‚æ•° | 2004   | æ–°å»ºä»»åŠ¡æ—¶status=true  |

### ğŸ“‚ æ¸…å•ç›¸å…³å¼‚å¸¸

| å¼‚å¸¸æè¿°     | é”™è¯¯ç  | è§¦å‘åœºæ™¯           |
| ------------ | ------ | ------------------ |
| é‡å¤æ¸…å•åˆ†ç±» | 3001   | åˆ›å»ºé‡å¤åˆ†ç±»çš„æ¸…å• |
| æ¸…å•ä¸å­˜åœ¨   | 3002   | æ“ä½œä¸å­˜åœ¨æ¸…å•     |

> [!WARNING] æ³¨æ„
> æœªå¤„ç†çš„å¼‚å¸¸å°†è¿”å›500é”™è¯¯ï¼š
>
> ```json
> {
> "code": 500,
> "message": "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•"
> }
> ```
>>>>>>> master
