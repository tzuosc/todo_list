# é¡¹ç›®ä»‹ç»

æœ¬é¡¹ç›®å°†è¦å®Œæˆä¸€ä¸ª TodoList ç³»ç»Ÿ, åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†

1. ç™»å½•å’Œæ³¨å†Œ
2. ä»»åŠ¡çš„å¢åˆ æ”¹æŸ¥
3. å„ç§è¾¹ç•Œå¼‚å¸¸çš„å¤„ç†
4. æƒé™çš„æ§åˆ¶(åªæœ‰ç™»å½•å’Œæ²¡æœ‰ç™»å½•ä¸¤ç§çŠ¶æ€, æ²¡æœ‰å…¶ä»–æƒé™)

æˆ‘å°†ä¼šä¿ç•™æ³¨å†Œç›¸å…³æµç¨‹çš„ä»£ç ç”¨äºç¤ºä¾‹, å…¶ä»–çš„ä»£ç éœ€è¦åŒå­¦ä»¬è‡ªå·±å®Œæˆ,
æœ¬é¡¹ç›®é‡‡ç”¨**æµ‹è¯•ç±»**æ¥æ£€éªŒé¡¹ç›®çš„**å®Œæˆåº¦**, åŒå­¦ä»¬åœ¨å®ŒæˆæŸä¸ªåŠŸèƒ½çš„ä»£ç ä¹‹åå¯ä»¥è‡ªå·±å…ˆæµ‹è¯•
ä¸€ä¸‹è‡ªå·±çš„æ¥å£å¯¹ä¸å¯¹, ç„¶åå†åˆ°æµ‹è¯•ç±»æµ‹è¯•ä¸€ä¸‹è¾¹ç•Œæƒ…å†µæ˜¯å¦è€ƒè™‘åˆ°äº†, æœ¬é¡¹ç›®æ²¡æœ‰**æ ‡å‡†ç­”æ¡ˆ**,
æ‰€æœ‰å¯ä»¥é€šè¿‡æµ‹è¯•ç±»çš„ä»£ç éƒ½æ˜¯æ ‡å‡†ç­”æ¡ˆ.

æŠ€æœ¯æ ˆ: mysql + spring boot + Maven + React(å¯é€‰)

# é¡¹ç›®è®¾è®¡

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚       â””â”€â”€ todo_list/
â”‚   â”‚           â”œâ”€â”€ controller/          // æ§åˆ¶å™¨å±‚ (REST API)
â”‚   â”‚           â”œâ”€â”€ service/             // æœåŠ¡å±‚ (ä¸šåŠ¡é€»è¾‘)
â”‚   â”‚           â”œâ”€â”€ repository/          // æ•°æ®è®¿é—®å±‚ (DAO)
â”‚   â”‚           â”œâ”€â”€ model/               // å®ä½“ç±» (JPA)
â”‚   â”‚           â”œâ”€â”€ dto/                 // æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚           â”œâ”€â”€ config/              // é…ç½®ç±»
â”‚   â”‚           â”œâ”€â”€ exception/           // å¼‚å¸¸å¤„ç†ç›¸å…³
â”‚   â”‚           â”œâ”€â”€ security/            // å®‰å…¨å¤„ç†ç›¸å…³
â”‚   â”‚           â”œâ”€â”€ utils/               // å·¥å…·ç±»
â”‚   â”‚           â””â”€â”€ Application.java     // ä¸»å¯åŠ¨ç±»
â”‚   â”œâ”€â”€ resources/
â”‚   â”‚   â”œâ”€â”€ application.yml              // åº”ç”¨é…ç½®æ–‡ä»¶ (YAML æ ¼å¼ä¸º application.yml)
â”‚   â”‚   â””â”€â”€ db.migration/                // flyway æ•°æ®åº“è¿ç§»ç›¸å…³æ–‡ä»¶
â””â”€â”€ test/
    â””â”€â”€ java/
        â””â”€â”€ com/
            â””â”€â”€ todo_list/               // æµ‹è¯•ä»£ç ç›®å½•
web/                                     // å‰ç«¯ä»£ç 
```

## æ¨¡å‹è®¾è®¡

> æœ¬é¡¹ç›®å…±æœ‰ä¸‰ä¸ªæ¨¡å‹. user(ç”¨æˆ·), task(ä»»åŠ¡), todolist(ä»»åŠ¡åˆ—è¡¨). ç”¨æˆ·ç”¨äºç®¡ç†ç™»å½•çŠ¶æ€, task ç”¨æˆ·ç®¡ç†æ‰€æœ‰å·²å®Œæˆçš„,
> æœªå®Œæˆçš„ä»»åŠ¡. todolist ç”¨äºç»Ÿä¸€ç®¡ç†æ‰€æœ‰ task

### USER

- username -> ç”¨æˆ·å : String
- password -> å¯†ç (éœ€è¦åŠ å¯†) : String
- avatar_url -> å¤´åƒ : String

### TASK(å¤šå¯¹ä¸€)

- task_name -> ä»»åŠ¡å : String
- task_description -> ä»»åŠ¡å¤‡æ³¨ : String
- deadline -> æˆªæ­¢æ—¥æœŸ(ä½¿ç”¨æ—¶é—´æˆ³) : Long
- status -> ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ : boolean
- todo_list_id -> todolist çš„å¤–é”® : Long

### TODOLIST(ä¸€å¯¹å¤š)

- category -> ä»»åŠ¡ç±»å‹ : String
- user_id -> user çš„å¤–é”® :Long

## æ¥å£è®¾è®¡

### å…³äº USER

- /user/register -> æ³¨å†Œ
    - POST
    - ä¼ å…¥å‚æ•°: username, password
    - è¿”å›: æ³¨å†ŒæˆåŠŸ
- /user/login -> ç™»å½•
    - POST
    - ä¼ å…¥å‚æ•°: username, password
    - è¿”å›: ç™»å½•æˆåŠŸæ·»åŠ å“åº”å¤´ setCookie, å€¼ä¸º token, å‰ç«¯æ‹¿åˆ°åæŒä¹…åŒ–å­˜å‚¨ä¸‹æ¥
- /user/logout -> ç™»å‡º
    - GET
    - è¿”å›: ç™»å‡ºæˆåŠŸ
- /user/{id} -> æ›´æ–°ç”¨æˆ·
    - PATCH
    - ä¼ å…¥: username || password || avatarUrl (ä¸€ä¸ªæˆ–å¤šä¸ªéƒ½è¡Œ)
    - è¿”å›: æ›´æ–°æˆåŠŸ
-  /user/upload/{id} -> ä¸Šä¼ å¤´åƒ(å›¾ç‰‡)
  - POST
  - ä¼ å…¥: ç”¨æˆ·id, å›¾ç‰‡
  - è¿”å›: å›¾ç‰‡åœ°å€

### å…³äº TODOLIST

- /list/{category}-> å»ºç«‹ä¸€ä¸ªç©ºåˆ—è¡¨
    - PUT
    - ä¼ å…¥å‚æ•°: category,
    - è¿”å›: æ–°å»ºæˆåŠŸ
- /list/{id} -> åˆ é™¤åˆ—è¡¨
    - DELETE
    - è¿”å›: åˆ é™¤æˆåŠŸ
- /list/change -> ä¿®æ”¹åˆ—è¡¨ç±»å‹
    - PATCH
    - ä¼ å…¥å‚æ•°: id, category
    - è¿”å›: æ˜¯å¦åˆ é™¤æˆåŠŸ
- /list/ -> è·å–æ‰€æœ‰åˆ—è¡¨
    - GET
    - è¿”å›: ä¸€ä¸ªåˆ—è¡¨ [[id, category, tasks[...]], [id, category1, tasks[...]], ...]
    - å¤‡æ³¨: åŠ è½½ä¸»ç•Œé¢çš„æ—¶å€™è°ƒç”¨è¿™ä¸ªæ¥å£, è¿™ä¸ªæ¥å£ä¸ä¼šç›´æ¥è¿”å› todo æ¨¡å‹, ç‚¹å‡»å¯¹åº”çš„todolist éœ€è¦è°ƒç”¨todoæ¥å£è·å–
- /list/{id}
    - GET
    - è¿”å›: ä¸€ä¸ªåˆ—è¡¨ [id, category , tasks[...]]

### å…³äº TASK

- /task/ -> æ–°å»ºä¸€ä¸ªä»»åŠ¡
    - POST
    - ä¼ å…¥å‚æ•°: category(å¿…é¡»), name(å¿…é¡»), status(å¿…é¡»ä¸ºfalse), description, deadline
    - è¿”å›: åˆ›å»ºæˆåŠŸ
- /task/{id} -> è·å–å•ä¸ªä»»åŠ¡
    - GET
    - è¿”å›: ä¸€ä¸ª task
- /task/{id} -> åˆ é™¤ä¸€ä¸ªä»»åŠ¡
    - DELETE
    - è¿”å›: åˆ é™¤æˆåŠŸ
- /task/{id}
    - PATCH
    - ä¼ å…¥å‚æ•°: category || name || status || description || deadline
    - è¿”å›: æ›´æ–°æˆåŠŸ

## å¼‚å¸¸å¤„ç†

> ä¸‹é¢æˆ‘åˆ—ä¸¾çš„å¼‚å¸¸æ˜¯éœ€è¦åœ¨æœåŠ¡å±‚å¤„ç†çš„å…·ä½“çš„ä¸šåŠ¡é€»è¾‘å¼‚å¸¸, æˆ‘è¡¨ç¤ºçš„æ–¹æ³•æ˜¯ å¼‚å¸¸å(å¼‚å¸¸ä»£ç )
> ä½ ä»¬é‡åˆ°å¯¹åº”çš„å¼‚å¸¸éœ€è¦æŠ›å‡ºå¯¹åº”çš„å¼‚å¸¸ä»£ç å’Œå¼‚å¸¸å, ä¾‹å¦‚é‡åˆ°äº†ä¼ å…¥éæ³•ç”¨æˆ·åå°±éœ€è¦æŠ›å‡º"éæ³•ç”¨æˆ·å", å¼‚å¸¸ä»£ç ä¸º 1001

### å…³äº User

- éæ³•ç”¨æˆ·å(1001) ç”¨æˆ·åå¿…é¡»æ˜¯å¤§å°å†™å­—æ¯æˆ–è€…æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿çš„ç»„åˆ, å¹¶ä¸”é•¿åº¦å¤§äº2.
    - ä¾‹å¦‚ aaa_AAA, bb1122
    - åä¾‹ ##, a, abcd$
- ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯(1002)
- ç”¨æˆ·åå·²å­˜åœ¨(1003)
- æ‰¾ä¸åˆ°ç”¨æˆ·(1005) æ›´æ–°çš„æ—¶å€™ä¼ å…¥äº†éæ³•çš„ id, å¯¼è‡´åˆ°ä¸åˆ°å¯¹åº”çš„ç”¨æˆ·
- æ²¡æœ‰ç™»å½•(1004) è¿™ä¸ªå¼‚å¸¸æˆ‘å·²ç»å¸®ä½ ä»¬å¤„ç†äº†

### å…³äº Task

- éæ³•æ—¶é—´(2001) ä¼ å…¥æˆªæ­¢æ—¥æœŸè¶…è¿‡äº† 2038 å¹´, è¿™æ˜¯æ—¶é—´æˆ³çš„æœ€å¤§è¡¨ç¤ºæ—¥æœŸ, è¡¨ç¤ºä¸ºæ—¶é—´æˆ³ä»–åº”è¯¥å°äº2147483647
- æ²¡æ‰¾åˆ°ä»»åŠ¡(2002) è·å–, åˆ é™¤, æ›´æ–°çš„æ—¶å€™ä¼ å…¥äº†éæ³•çš„ id
- ä¸æ˜¯å°†æ¥çš„æ—¶é—´(2003) ä¼ å…¥æˆªè‡³æ—¥æœŸä½†æ˜¯ä¼ å…¥äº†è¿‡å»çš„æ—¶é—´
- é”™è¯¯çš„çŠ¶æ€(2004) ä¼ å…¥ä»»åŠ¡æ˜¯å¦å®Œæˆçš„çŠ¶æ€ä½†æ˜¯ä¼ å…¥äº† true, æ–°å»ºä¸€ä¸ªä»»åŠ¡é»˜è®¤å®Œæˆçš„çŠ¶æ€åº”è¯¥æ˜¯ false

### å…³äº List

- é‡å¤ç±»å‹çš„ä»»åŠ¡(3001) æ–°å»ºä»»åŠ¡åˆ—è¡¨çš„æ—¶å€™ä¼ å…¥äº†é‡å¤çš„ç±»åˆ«
- æ²¡æ‰¾åˆ°ä»»åŠ¡åˆ—è¡¨(3002) æ›´æ–°æˆ–è€…è·å–çš„æ—¶å€™ä¼ å…¥éæ³• id

> [!warning]
>
> æ³¨æ„: å¦‚æœä½ å†™çš„ä»£ç å¯¹è¾¹ç•Œæƒ…å†µè€ƒè™‘çš„ä¸å……åˆ†, å½“äº§ç”Ÿäº†å¼‚å¸¸, å´æ²¡æœ‰è¢«ä½ æ•è·çš„æ—¶å€™, ä»£ç ä¼šæŠ›å‡º `500` å¼‚å¸¸ å¹¶æ˜¾ç¤º
> `ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åé‡è¯•`.
>
> ä¸ºäº†æ–¹ä¾¿æ•™å­¦, æ‰€æœ‰ä¸šåŠ¡é€»è¾‘å¼‚å¸¸çš„çŠ¶æ€ç ç»Ÿä¸€ä¸º 400.

# å‡†å¤‡å·¥ä½œ

## maven æ¢æº

æ–°å»ºä¸€ä¸ª xml æ–‡ä»¶, å¦‚æœæ²¡æœ‰çš„è¯, è·¯å¾„æ˜¯

```angular2html
C:\Users\ä½ çš„ç”¨æˆ·å\.m2\settings.xml
```

å¡«å…¥

```angular2html

<settings>
    <mirrors>
        <mirror>
            <id>aliyunmaven</id>
            <name>é˜¿é‡Œäº‘å…¬å…±ä»“åº“</name>
            <url>https://maven.aliyun.com/repository/public</url>
            <mirrorOf>central</mirrorOf>
        </mirror>
    </mirrors>
</settings>
```

ç„¶ååˆ° IDEA è¿è¡Œ

```angular2html
mvn clean install -T 1C
```

## è®¾ç½® jdk

![image-20250422145405621](assets/image-20250422145405621.png)

![image-20250422145458973](assets/image-20250422145458973.png)

ç„¶åé€‰æ‹©å¹¶ä¸‹è½½ `jdk21` , ç¡®ä¿ä½ çš„é¡¹ç›®çš„ jdk ç‰ˆæœ¬æ˜¯ 21 å¦åˆ™å¯èƒ½æ— æ³•å¯åŠ¨é¡¹ç›®.

## è¿æ¥æ•°æ®åº“

ç¡®ä¿ä½ çš„ mysql æœ‰è¿™æ ·ä¸€ä¸ªæ•°æ®åº“ `TodoList` , å¦‚æœæ²¡æœ‰çš„è¯å°±æ–°å»ºä¸€ä¸ª.

```sql
create database TodoList;
use TodoList;
```

åˆ° `src/main/resources/application.yml` å¯ä»¥çœ‹åˆ°æˆ‘è®¾ç½®çš„æ•°æ®åº“çš„è´¦å·å’Œå¯†ç 

![image-20250422150014976](assets/image-20250422150014976.png)

æˆ‘é»˜è®¤è®¾ç½®çš„æ˜¯ root , root . å¦‚æœä½ çš„æ•°æ®åº“çš„è´¦å·å’Œå¯†ç ä¸åŒ, è¯·æŠŠè¿™ä¸ªåœ°æ–¹çš„é…ç½®ä¿®æ”¹æˆä½ çš„ç”¨æˆ·åå’Œå¯†ç .

ç„¶åæ¥ä¸‹æ¥æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹æ˜¯å¦èƒ½è¿æ¥

![image-20250422150309907](assets/image-20250422150309907.png)

![image-20250422150339347](assets/image-20250422150339347.png)

åœ¨ `1, 2` çš„ä½ç½® å¡«å…¥ä½ çš„è´¦å·å¯†ç . `3` å¤„å¦‚æœä½ æ²¡æœ‰ä¸‹è½½å¯åŠ¨ç¨‹åºä»–ä¼šå…ˆè¦æ±‚ä½ ä¸‹è½½é©±åŠ¨, ç‚¹ä¸€ä¸‹å°±è¡Œäº†. å¦‚æœæµ‹è¯•è¿æ¥å¤±è´¥è¯·æ£€æŸ¥ä¸€ä¸‹
mysql æœ‰æ²¡æœ‰å®‰è£…åˆ°ä½ çš„ç”µè„‘ä¸Š, ç„¶åæ£€æŸ¥ä¸€ä¸‹è‡ªå·±çš„è´¦å·å¯†ç å¯¹ä¸å¯¹.

## å‰ç½®çŸ¥è¯†

> æƒ³è¦å¼€å§‹æœ¬é¡¹ç›®, ä½ è‡³å°‘éœ€è¦äº†è§£ä¸‹é¢çš„ç›¸å…³çŸ¥è¯†.

- [ ] ä»€ä¹ˆæ˜¯ `JWT` , å¦‚ä½•ä½¿ç”¨. (ç™»å½•, æ³¨å†Œæœ‰ç”¨)
- [ ] ä»€ä¹ˆæ˜¯ç½‘ç»œæ‹¦æˆªå™¨, å®ƒæ˜¯å¦‚ä½•é˜»æ­¢æ²¡æœ‰ç™»é™†çš„ç”¨æˆ·è®¿é—®åç«¯æ¥å£çš„. ä»¥åŠä»€ä¹ˆæ˜¯ Cookie
- [ ] ä»€ä¹ˆæ˜¯ Java å¼‚å¸¸å¤„ç†. (æœ¬é¡¹ç›®é‡‡ç”¨å…¨å±€å¼‚å¸¸å¤„ç†çš„æ–¹å¼, è¿™ç¬¦åˆæœ€ä½³å®è·µ)
- [ ] ä»€ä¹ˆæ˜¯ JPA (spring boot çš„æŒä¹…å±‚)
- [ ] ä»€ä¹ˆæ˜¯ DTO, å¦‚ä½•è®¾è®¡ä¸€ä¸ªåˆç†çš„ DTO.
- [ ] ä»€ä¹ˆæ˜¯æ¥å£æ–‡æ¡£(Swagger)
- [ ] ä»€ä¹ˆæ˜¯ RESTful API è§„èŒƒ, å¦‚ä½•è®¾è®¡ä¸€ä¸ªåˆç†çš„æ¥å£

è¿˜æœ‰ä¸€äº› java çš„çŸ¥è¯†

- [ ] ä»€ä¹ˆæ˜¯ æšä¸¾ç±», çºªå½•ç±»

é™¤æ­¤ä¹‹å¤–, ä½ è¿˜éœ€è¦ç®€å•äº†è§£ä¸€ä¸‹ spring boot æ˜¯å¦‚ä½•è¿›è¡Œæµ‹è¯•çš„.

## ç¬¬ä¸€ä¸ªæ¥å£

> å¦‚æœä¸Šè¿°æ­¥éª¤ä½ éƒ½æ²¡æœ‰é—®é¢˜, é‚£å°±å¯ä»¥å¼€å§‹æµ‹è¯•æˆ‘ç•™ä¸‹æ¥çš„ç¬¬ä¸€ä¸ªæ¥å£äº†. è¿™ä¸ªæ¥å£æˆ‘ä¿ç•™äº†å…¨éƒ¨çš„æµç¨‹, æ–¹ä¾¿åŒå­¦ä»¬æ›´æ·±åˆ»çš„ç†è§£æœ¬é¡¹ç›®.

å…ˆæŠŠé¡¹ç›®è·‘èµ·æ¥. åˆ°è¿™ä¸ªç½‘å€

``` url
http://localhost:8080/swagger-ui/index.html
```

![image-20250422153216867](assets/image-20250422153216867.png)

![image-20250422153319116](assets/image-20250422153319116.png)

å¦‚æœæ˜¾ç¤ºæ³¨å†ŒæˆåŠŸ, é‚£ä¹ˆé¡¹ç›®çš„å‡†å¤‡å·¥ä½œå°±åˆ°æ­¤ä¸ºæ­¢, å¯ä»¥å¼€å§‹ç¼–å†™è‡ªå·±çš„ä»£ç äº†.



# å‰ç«¯é¡¹ç›®è®¾è®¡

## é¡¹ç›®å‰ç½®å‡†å¤‡

æœ¬é¡¹ç›®åŸºäº **[Vite](https://vitejs.dev/)** + **React** + **TypeScript**ï¼Œä½¿ç”¨äº† **[Tailwind CSS](https://tailwindcss.com/)** ä½œä¸ºåŸå­åŒ– CSS å·¥å…·ï¼Œå¹¶é›†æˆäº† **shadcn/ui** ç»„ä»¶åº“ã€‚ä½¿ç”¨ä¹‹å‰è¯·å®Œæˆä»¥ä¸‹å‰ç½®å·¥ä½œï¼š

+ **å®‰è£…Viteè„šæ‰‹æ¶**

  ```powershell
  npm create vite@latest
  pnpm create vite (æ¨è)
  ```

  (pnpmä¸‹è½½å¾—åŸºäºnpm,æ²¡æœ‰å®‰è£…pnpmå» [pnpmä¸­æ–‡æ–‡æ¡£](https://www.pnpm.cn/installation) è‡ªå·±æ‰¾ï¼Œæ¢æºä»€ä¹ˆçš„ä¸å¤šèµ˜è¿°)

+ **é…ç½®Tailwind CSS**
  ğŸ“„ Tailwind CSS å®˜ç½‘æ–‡æ¡£ï¼š
   ğŸ‘‰ https://tailwindcss.com/docs/installation

+ **é…ç½®shadcn/uiç»„ä»¶**
  ğŸ“„ shadcn/ui å®˜ç½‘é…ç½®æ–‡æ¡£ï¼š
   ğŸ‘‰ https://ui.shadcn.dev/docs/installation


  **(å»ºè®®å…ˆå»é…ç½®shadcn/ui,å†å»çœ‹Tailwind CSSã€‚shadcné…ç½®æ–‡æ¡£ä¼šæ•™ä½ å¦‚ä½•é…ç½®Tailwind CSSã€‚ä½¿ç”¨ shadcn ç»„ä»¶å‰ï¼ŒTailwind å¿…é¡»å·²æ­£ç¡®é…ç½®)**

## é¡¹ç›®ç»“æ„

```markdown
web/
â”œâ”€â”€ node_modules/            // é¡¹ç›®ä¾èµ–æ–‡ä»¶å¤¹ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ public/                  // å…¬å…±èµ„æºç›®å½•
â”œâ”€â”€ src/                     // æºä»£ç ä¸»ç›®å½•
â”‚   â”œâ”€â”€ api/                 // æ¥å£è¯·æ±‚å°è£…ï¼ˆå¦‚ axios å®ä¾‹ã€API æ–¹æ³•ç­‰ï¼‰
â”‚   â”œâ”€â”€ assets/              // é™æ€èµ„æºç›®å½•
â”‚   â”œâ”€â”€ components/          // é€šç”¨ç»„ä»¶åº“ï¼ˆæŒ‰é’®ã€æ¨¡æ€æ¡†ç­‰ï¼‰
â”‚   â”œâ”€â”€ lib/                 // ç¬¬ä¸‰æ–¹åº“å°è£…æˆ–å·¥å…·åº“
â”‚   â”œâ”€â”€ models/              // ç±»å‹æ¨¡å‹å®šä¹‰ï¼ˆå¦‚æ¥å£å“åº”ç»“æ„ç­‰ï¼‰
â”‚   â”œâ”€â”€ pages/               // é¡µé¢çº§ç»„ä»¶ï¼ˆè·¯ç”±ç»„ä»¶ï¼‰
â”‚   â”œâ”€â”€ router/              // è·¯ç”±é…ç½®æ–‡ä»¶ï¼ˆå¦‚ react-router-dom é…ç½®ï¼‰
â”‚   â”œâ”€â”€ storages/            // æœ¬åœ°å­˜å‚¨å°è£…ï¼ˆlocalStorage ç­‰ï¼‰
â”‚   â”œâ”€â”€ styles/              // å…¨å±€æ ·å¼æ–‡ä»¶ï¼ˆå¦‚ Tailwindã€å…¨å±€ CSSï¼‰   ä»‹ç»
â”‚   â”œâ”€â”€ types/               // å…¨å±€ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils/               // å·¥å…·å‡½æ•°ï¼ˆå¦‚æ—¥æœŸå¤„ç†ã€åŠ å¯†ç­‰ï¼‰
â”‚   â”œâ”€â”€ App.tsx              // åº”ç”¨ä¸»ç»„ä»¶
â”‚   â”œâ”€â”€ main.tsx             // åº”ç”¨å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ vite-env.d.ts        // Vite çš„ç¯å¢ƒç±»å‹å®šä¹‰
â”œâ”€â”€ .gitignore               // Git å¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ .prettierrc              // Prettier ä»£ç æ ¼å¼åŒ–é…ç½®  ä»‹ç»
â”œâ”€â”€ components.json          // ç»„ä»¶åº“é…ç½®ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ eslint.config.js         // ESLint é…ç½®æ–‡ä»¶
â”œâ”€â”€ index.html               // HTML å…¥å£æ–‡ä»¶
â”œâ”€â”€ package.json             // é¡¹ç›®ä¿¡æ¯å’Œä¾èµ–åˆ—è¡¨
â”œâ”€â”€ package-lock.json        // é”å®šä¾èµ–ç‰ˆæœ¬
â”œâ”€â”€ README.md                // é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ tsconfig.json            // TypeScript åŸºç¡€é…ç½®
â”œâ”€â”€ tsconfig.app.json        // åº”ç”¨ä¸“ç”¨çš„ TS é…ç½®
â”œâ”€â”€ tsconfig.node.json       // Node ç¯å¢ƒçš„ TS é…ç½®
â””â”€â”€ vite.config.ts           // Vite é…ç½®æ–‡ä»¶

```
## ğŸ§© å‰ç«¯é€šç”¨å·¥å…·ä¸ç±»å‹å®šä¹‰è¯´æ˜

æœ¬æ–‡ä»¶ä¸»è¦è¯´æ˜äº†é¡¹ç›®ä¸­ `types/`ã€`utils/` ç›®å½•ä¸‹çš„å·¥å…·å‡½æ•°ã€ç±»å‹å®šä¹‰ä¸å…¨å±€é…ç½®ç”¨é€”åŠä½¿ç”¨æ–¹å¼

### ğŸ“ `types/index.tsx`

#### `WebResponse<T>`

ç»Ÿä¸€å®šä¹‰æ¥å£å“åº”ç»“æ„ï¼Œé€‚ç”¨äºæ‰€æœ‰åç«¯ API é€šä¿¡çš„æ³›å‹å°è£…ã€‚

```ts
export interface WebResponse<T> {
  code: number;        // çŠ¶æ€ç ï¼Œå¦‚ 200 è¡¨ç¤ºæˆåŠŸï¼Œ1004 è¡¨ç¤ºæœªç™»å½•ç­‰
  data?: T;            // è¿”å›çš„æ³›å‹æ•°æ®
  msg?: string;        // é”™è¯¯æˆ–æˆåŠŸæç¤ºä¿¡æ¯
  ts: number;          // æ—¶é—´æˆ³
  total?: number;      // æ•°æ®æ€»é‡ï¼ˆç”¨äºåˆ†é¡µï¼‰
}
```



### ğŸ“ `utils/index.ts`

ğŸ§© `cn(...)` å·¥å…·å‡½æ•°

```ts
import { clsx, type ClassValue } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

##### âœ… åŠŸèƒ½è¯´æ˜

- ç”¨äºåˆå¹¶å¤šä¸ªç±»åå­—ç¬¦ä¸²ï¼Œè‡ªåŠ¨è§£å†³ Tailwind CSS çš„ç±»å†²çªã€‚
- ç±»ä¼¼ `classnames`ï¼Œä½†å¢å¼ºäº† Tailwind ä¸“ç”¨çš„åˆå¹¶é€»è¾‘ã€‚

### ğŸ“ `utils/alova.ts`

#### ğŸŒ ç½‘ç»œè¯·æ±‚å°è£…

ä½¿ç”¨ alova é…åˆ fetch æ„å»ºç»Ÿä¸€è¯·æ±‚å™¨ã€‚

```ts
import { createAlova } from "alova";
import adapterFetch from "alova/fetch";

export const alova = createAlova({
  baseURL: "/api",
  requestAdapter: adapterFetch(),
  timeout: 5000,
  shareRequest: true,
  statesHook: ReactHook,
  responded: {
    onSuccess: async (response, _method) => {
      const res = await response.json();
      // é€šç”¨æ‹¦æˆªé€»è¾‘
    }
  }
});
```

##### ğŸ” é€šç”¨æ‹¦æˆªé€»è¾‘

- `1004`: æœªç™»å½• â†’ è·³è½¬ç™»å½•é¡µå¹¶æ¸…é™¤ç”¨æˆ·çŠ¶æ€ã€‚
- `502`: åç«¯æŒ‚äº† â†’ å¼¹å‡ºé”™è¯¯æç¤ºã€‚

### ğŸ“ `utils/global-router.ts`

#### ğŸŒ å…¨å±€è·¯ç”±è·³è½¬æ”¯æŒ

```ts
const globalRouter = { navigate: undefined } as {
  navigate?: NavigateFunction;
};

export default globalRouter;
```

##### ğŸ§­ ä½¿ç”¨æ–¹å¼ (å…·ä½“çš„ä½¿ç”¨åœ¨é¡¹ç›®ä»£ç é‡Œå†™äº†æ³¨é‡Š)

åœ¨ `layout.tsx` ä¸­åˆå§‹åŒ–ï¼š

```tsx
globalRouter.navigate = useNavigate();
```



## ğŸ“¦ çŠ¶æ€ç®¡ç†æ¨¡å—ï¼š`storages/`

### 1. `auth.ts` - ç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†

**è·¯å¾„**ï¼š`storages/auth.ts`
 **ä¾èµ–**ï¼š[Zustand](https://github.com/pmndrs/zustand)ã€`User` æ¨¡å‹

```ts
// storages/auth.ts

import { User } from "@/models/user";
import { create } from "zustand";
import { createJSONStorage, persist } from "zustand/middleware";

/**
 * âœ… è¯´æ˜ï¼š
 * å…¨å±€ç”¨æˆ·è®¤è¯çŠ¶æ€ç®¡ç†
 * - ä½¿ç”¨ zustand ç®¡ç†ç”¨æˆ·ç™»å½•ä¿¡æ¯
 * - æ”¯æŒæŒä¹…åŒ–å­˜å‚¨ï¼ˆlocalStorageï¼‰ï¼Œå®ç°åˆ·æ–°é¡µé¢åä»ä¿æŒç™»å½•
 *
 * âœ… ä¸ºä»€ä¹ˆä½¿ç”¨ zustandï¼Ÿ
 * - ç®€æ´è½»é‡
 * - ä½¿ç”¨ç®€å•ä½†åŠŸèƒ½å¼ºå¤§(persist)
 */

// ç”¨æˆ·çŠ¶æ€æ¥å£
interface AuthState {
    user?: User;                      // å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆåŒ…æ‹¬ç”¨æˆ·åã€å¤´åƒç­‰ï¼‰
    setUser: (user?: User) => void;  // è®¾ç½®ç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å½•åä½¿ç”¨ï¼‰
    clear: () => void;               // æ¸…ç©ºç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å‡ºæ—¶ä½¿ç”¨ï¼‰
}

// åˆ›å»ºçŠ¶æ€ç®¡ç†ï¼šuseAuthStore åŒ…å« user, setUser, clear
export const useAuthStore = create<AuthState>()(
    persist(
        (set, _get) => ({
            setUser: (user?: User) => set({ user }),     // è®¾ç½®ç”¨æˆ·
            clear: () => set({ user: undefined }),       // æ¸…ç©ºç”¨æˆ·
        }),
        {
            name: "auth",                                 // localStorage çš„ key åç§°
            storage: createJSONStorage(() => localStorage), // ä½¿ç”¨ localStorage å­˜å‚¨
        }
    )
);

```



#### âœ… åŠŸèƒ½è¯´æ˜

`auth.ts` ä½¿ç”¨ `zustand` ç®¡ç†å…¨å±€çš„ç”¨æˆ·è®¤è¯çŠ¶æ€ã€‚å®ƒè´Ÿè´£ï¼š

- å­˜å‚¨å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åã€å¤´åƒç­‰ï¼‰
- åœ¨ç”¨æˆ·ç™»å½•ã€é€€å‡ºæ—¶æ›´æ–°çŠ¶æ€
- åˆ©ç”¨ `zustand/middleware/persist` æ’ä»¶å°†çŠ¶æ€æŒä¹…åŒ–åˆ° `localStorage`ï¼Œæ”¯æŒé¡µé¢åˆ·æ–°åçš„çŠ¶æ€ä¿æŒ

#### ğŸ“˜ ä½¿ç”¨åœºæ™¯

- åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
- è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ç”¨äºå±•ç¤ºï¼ˆå¦‚å¤´åƒã€æ˜µç§°ï¼‰
- å®ç°é€€å‡ºç™»å½•æ—¶çš„çŠ¶æ€æ¸…é™¤
- é¡µé¢åˆ·æ–°åè‡ªåŠ¨ä¿æŒç™»å½•çŠ¶æ€

é€šè¿‡ `useAuthStore()` å¯è®¿é—®ï¼š

- `user`: å½“å‰ç”¨æˆ·å¯¹è±¡ï¼ˆå¯ä¸ºç©ºï¼‰
- `setUser(user?: User)`: è®¾ç½®ç”¨æˆ·ä¿¡æ¯
- `clear()`: æ¸…é™¤ç”¨æˆ·ä¿¡æ¯ï¼ˆç™»å‡ºæ—¶è°ƒç”¨ï¼‰

### 2. `shared.ts` - é€šç”¨åˆ·æ–°çŠ¶æ€ç®¡ç†

**è·¯å¾„**ï¼š`storages/shared.ts`
 **ä¾èµ–**ï¼šä»…ä¾èµ– `zustand`

```ts
// storages/shared.ts

import { create } from "zustand";

/**
 * âœ… è¯´æ˜ï¼š
 * ç”¨äºç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€çš„å…¨å±€ store
 * å½“å‰ä»…ç”¨äºæä¾›é¡µé¢/ç»„ä»¶åˆ·æ–°ä¿¡å·
 *
 * ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼š
 * - ç”¨æˆ·æ›´æ–°ä¿¡æ¯åï¼Œéœ€è¦å…¶ä»–ç»„ä»¶é‡æ–°æ‹‰å–æ•°æ®
 * - ç‚¹å‡»æŸä¸ªæ“ä½œï¼Œæƒ³é€šçŸ¥å¤šä¸ªç»„ä»¶é‡æ–°åŠ è½½
 */

// å…±äº«çŠ¶æ€æ¥å£
interface SharedState {
    refresh: number;        // æ¯æ¬¡æ›´æ–°éƒ½ä¼šè‡ªå¢ï¼Œè§¦å‘ä¾èµ–è¯¥å€¼çš„ç»„ä»¶é‡æ–°æ¸²æŸ“
    setRefresh: () => void; // æ‰§è¡Œä¸€æ¬¡åˆ·æ–°ï¼šrefresh + 1
}

// åˆ›å»ºå…±äº«çŠ¶æ€ç®¡ç†ï¼šuseSharedStore åŒ…å« refresh å’Œ setRefresh
export const useSharedStore = create<SharedState>()((set, get) => ({
    refresh: 0,
    setRefresh: () => set({ refresh: get().refresh + 1 }),
}));

```



#### âœ… åŠŸèƒ½è¯´æ˜

`shared.ts` æä¾›ä¸€ä¸ªç®€å•çš„å…¨å±€çŠ¶æ€ `refresh`ï¼Œç”¨äºè·¨ç»„ä»¶ä¼ é€’â€œåˆ·æ–°ä¿¡å·â€ã€‚

- é€šè¿‡é€’å¢çš„ `refresh` æ•°å€¼ï¼Œå®ç°ä¾èµ–ç»„ä»¶çš„å“åº”å¼åˆ·æ–°
- é€‚åˆç”¨åœ¨â€œæŸä¸ªåœ°æ–¹æ•°æ®å˜äº†ï¼Œå…¶ä»–åœ°æ–¹éœ€è¦æ„ŸçŸ¥å¹¶åˆ·æ–°â€è¿™ç§åœºæ™¯ä¸­

#### ğŸ“˜ ä½¿ç”¨åœºæ™¯ (åœ¨update-list-dialogä¸­çš„ä¾‹å­)

```tsx
const sharedStore = useSharedStore()
const onSubmit = form.handleSubmit(async (values) => {
        setLoading(true)
        try {
            ...
            if (res.code === 200) {
                sharedStore.setRefresh()// åœ¨æ“ä½œæˆåŠŸåæ‰‹åŠ¨è§¦å‘ä¸€æ¬¡å…¨å±€åˆ·æ–°ä¿¡å·ï¼Œä¾§è¾¹æ ä¼šå‡ºç°æ–°çš„liståå­—
                onClose()
                navigate(`/list/${values.category}`)//ç„¶åè·³è½¬åˆ°æ›´æ–°çš„listé¡µé¢
            } ...
        } catch (err) {
           ...
        } finally {
            ...
        }
    })
return (
    ...
    <Form{...form}>
    	...
        <form onSubmit={onSubmit}...>
        	<Button
            ...
            type={"submit"}>
        	...
        	</Button>
        </form>
    </Form>
```



é€šè¿‡ `useSharedStore()` å¯è®¿é—®ï¼š

- `refresh`: æ•°å€¼ï¼Œæ¯æ¬¡è°ƒç”¨ `setRefresh()` éƒ½ä¼š +1
- `setRefresh()`: ç”¨äºæ‰‹åŠ¨è§¦å‘åˆ·æ–°



## ğŸ“ `models/user.ts` æ¨¡å—è¯´æ˜æ–‡æ¡£

### âœ… ä½œç”¨

å®šä¹‰é¡¹ç›®ä¸­ä¸ã€Œç”¨æˆ·ï¼ˆUserï¼‰ã€ç›¸å…³çš„æ•°æ®ç»“æ„ï¼Œå³ `User` ç±»å‹æ¥å£ã€‚å®ƒç”¨äºæ ‡è¯†ã€çº¦æŸç”¨æˆ·å¯¹è±¡åŒ…å«çš„å­—æ®µç±»å‹ï¼Œæ˜¯æ•´ä¸ªé¡¹ç›®åœ¨ç™»å½•ã€æ³¨å†Œã€æ›´æ–°ç”¨æˆ·ä¿¡æ¯ç­‰æ“ä½œä¸­ç»Ÿä¸€ä½¿ç”¨çš„ç”¨æˆ·æ¨¡å‹ã€‚

### ğŸ“¦ User æ¥å£å­—æ®µè¯´æ˜

```ts
export interface User {
    id?: number; // ç”¨æˆ· ID
    username?: string; // ç”¨æˆ·å
    password?: string; // å¯†ç ï¼ˆç™»å½•æˆ–æ³¨å†Œæ—¶ç”¨ï¼‰
    confirm_password?: string; // ç¡®è®¤å¯†ç ï¼ˆæ³¨å†Œæ—¶ä½¿ç”¨ï¼‰
    avatarUrl?: string; // ç”¨æˆ·å¤´åƒ URL
}
```

> æ‰€æœ‰å­—æ®µå‡ä¸º ?ï¼ˆ`è¡¨ç¤ºå¯é€‰`ï¼‰ï¼Œä»¥æ–¹ä¾¿åœ¨è¡¨å•å¤„ç†ã€å±€éƒ¨æ›´æ–°æ—¶ä½¿ç”¨ã€‚

### ğŸ§  ä½¿ç”¨åœºæ™¯

- æ³¨å†Œè¡¨å•ä¸­ï¼Œä½¿ç”¨ `User` æ¨¡å‹è¿›è¡Œç±»å‹æ¨å¯¼ï¼›
- ç™»å½•å“åº”ä¸­ï¼ŒæœåŠ¡ç«¯è¿”å›çš„ç”¨æˆ·æ•°æ®ç»Ÿä¸€ä½¿ç”¨è¯¥ç»“æ„ï¼›
- åœ¨å…¨å±€çŠ¶æ€ `auth.ts` ä¸­å­˜å‚¨çš„ `user` ç±»å‹ä¹Ÿæ˜¯è¯¥æ¥å£ã€‚

## ğŸ“ `api/user/index.ts` æ¨¡å—è¯´æ˜æ–‡æ¡£

### âœ… ä½œç”¨

å°è£…ä¸ã€Œç”¨æˆ·ã€ç›¸å…³çš„æ‰€æœ‰ API è¯·æ±‚æ–¹æ³•ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½é€šè¿‡ `alova` è¯·æ±‚å®ä¾‹å‘å‡ºï¼Œå¹¶ç»Ÿä¸€ä½¿ç”¨ `WebResponse` ç±»å‹å°è£…å“åº”ç»“æœã€‚

### ğŸ“¡ API ä¸€è§ˆè¡¨

| æ–¹æ³•å         | è¯·æ±‚è·¯å¾„         | è¯·æ±‚æ–¹å¼ | ç”¨é€”         |
| -------------- | ---------------- | -------- | ------------ |
| `login`        | `/user/login`    | POST     | ç™»å½•         |
| `logout`       | `/user/logout`   | GET      | æ³¨é”€ç™»å½•     |
| `register`     | `/user/register` | POST     | æ³¨å†Œè´¦å·     |
| `updateUser`   | `/user`          | PATCH    | ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ |
| `uploadAvatar` | `/user/upload`   | POST     | ä¸Šä¼ ç”¨æˆ·å¤´åƒ |



### ğŸ§© è¯·æ±‚ç±»å‹å®šä¹‰

```ts
// ç™»å½•è¯·æ±‚ä½“
export interface UserLoginRequest {
    username: string;
    password: string;
}

// æ³¨å†Œè¯·æ±‚ä½“
export interface UserRegisterRequest {
    username: string;
    password: string;
    confirm_password: string;
}

// æ›´æ–°ç”¨æˆ·ä¿¡æ¯è¯·æ±‚ä½“
export interface UserUpdateRequest {
    id: number;
    username?: string;
    password?: string;
}
```



### ğŸ”„ å“åº”æ ¼å¼ç»Ÿä¸€å°è£…

æ‰€æœ‰ API å“åº”éƒ½ä½¿ç”¨å¦‚ä¸‹é€šç”¨æ ¼å¼å°è£…ï¼š

```ts
interface WebResponse<T> {
    code: number;
    data?: T;
    msg?: string;
    ts: number;
    total?: number;
}
```

ä¾‹å¦‚ï¼š

- ç™»å½•è¿”å›ï¼š`WebResponse<User>`
- ä¸Šä¼ å¤´åƒè¿”å›ï¼š`WebResponse<string>`ï¼ˆè¿”å›å¤´åƒåœ°å€ï¼‰
